# Percona Server for MySQL

This chart deploys Percona Server for MySQL Cluster on Kubernetes controlled by Percona Operator for MySQL.

Useful links:
- [Operator Github repository](https://github.com/percona/percona-server-mysql-operator)
- [Operator Documentation](https://www.percona.com/doc/kubernetes-operator-for-mysql/ps/index.html)

## Pre-requisites
* Percona Operator for MySQL running in your Kubernetes cluster. See installation details [here](https://github.com/percona/percona-helm-charts/blob/main/charts/ps-operator) or in the [Operator Documentation](https://www.percona.com/doc/kubernetes-operator-for-mysql/helm.html).
* Kubernetes 1.30+
* Helm v3

# Chart Details
This chart will deploy Percona Server for MySQL Cluster in Kubernetes. It will create a Custom Resource, and the Operator will trigger the creation of corresponding Kubernetes primitives: StatefulSets, Pods, Secrets, etc.

## Installing the Chart
To install the chart with the `ps` release name using a dedicated namespace (recommended):

```sh
helm repo add percona https://percona.github.io/percona-helm-charts/
helm install my-db percona/ps-db --version 0.12.0 --namespace my-namespace
```

The chart can be customized using the following configurable parameters:

| Parameter                                           | Description                                                                                                                                                             | Default                     |
| --------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------- |
| `crVersion`                                         | CR Cluster Manifest version                                                                                                                                             | `0.12.0`                    |
| `finalizers:percona.com/delete-mysql-pods-in-order` | Set this if you want to delete MySQL pods in order on cluster deletion                                                                                                  | `[]`                        |
| `finalizers:percona.com/delete-ssl`                 | Deletes objects created for SSL (Secret, certificate, and issuer) after the cluster deletion                                                                            | `[]`                        |
| `pause`                                             | Stop PS Cluster safely                                                                                                                                                  | `false`                     |
| `unsafeFlags.mysqlSize`                             | Allows users to start the cluster with less than 3 MySQL instances or with more than 9 (the maximum safe size)                                                          | `false`                     |
| `unsafeFlags.proxy`                                 | Allows users to configure a cluster with disabled proxy (HAProxy and Router).                                                                                           | `false`                     |
| `unsafeFlags.proxySize`                             | Allows users to set proxy (HAProxy or Router) size to a value less than 2 Pods (if `false`, the Operator will automatically change unsafe parameters to safe defaults)  | `false`                     |
| `unsafeFlags.orchestrator`                          | Allows users to configure a cluster with disabled Orchestrator even if asynchronous replication is turned on                                                            | `false`                     |
| `unsafeFlags.orchestratorSize`                      | Allows users to set orchestrator.size option to a value less than the minimum safe size (3)                                                                             | `false`                     |
| `initContainer.image`                               | An alternative image for the initial Operator installation                                                                                                              | `""`                        |
| `initContainer.containerSecurityContext`            | A custom Kubernetes Security Context for an init container                                                                                                              | `{}`                        |
| `initContainer.resources.requests`                  | Init container resource requests                                                                                                                                        | `{}`                        |
| `initContainer.resources.limits`                    | Init container resource limits                                                                                                                                          | `{}`                        |
| `updateStrategy`                                    | Strategy for updating pods in a cluster (SmartUpdate, OnDelete, RollingUpdate)                                                                                          | `SmartUpdate`               |
| `upgradeOptions.versionServiceEndpoint`             | Endpoint for actual PS Versions provider                                                                                                                                | `https://check.percona.com` |
| `upgradeOptions.apply`                              | PS image to apply from version service - `recommended`, `latest`, actual version like `8.0.40-31`                                                                       | `disabled`                  |
| `secretsName`                                       | Secret name for user passwords                                                                                                                                          | `<cluster_name>-secrets`    |
| `sslSecretName`                                     | Secret name for ssl certificates                                                                                                                                        | `{}`                        |
| `ignoreAnnotations`                                 | Mark annotations which will be ignored by the operator                                                                                                                  | `[]`                        |
| `ignoreLabels`                                      | Mark labels which will be ignored by the operator                                                                                                                       | `[]`                        |
| `metadata.labels`                                   | The Kubernetes labels for all objects created by the operator                                                                                                           | `{}`                        |
| `metadata.annotations`                              | The Kubernetes annotations for all objects created by the operator                                                                                                      | `{}`                        |
| `tls.SANs`                                          | Additional domains (SAN) to be added to the TLS certificate within the extended cert-manager configuration                                                              | `[]`                        |
| `tls.issuerConf.name`                               | A cert-manager issuer name                                                                                                                                              | `""`                        |
| `tls.issuerConf.kind`                               | A cert-manager issuer type                                                                                                                                              | `""`                        |
| `tls.issuerConf.group`                              | A cert-manager issuer group                                                                                                                                             | `""`                        |
||
| `mysql.clusterType`                               | MySQL Cluster type (`async` or `group-replication`)                                                                                                           | `group-replication`        |
| `mysql.autoRecovery`                              | Enable/Disable auto recovery from full cluster crash                                                                                                          | `true`                     |
| `mysql.podDisruptionBudget.maxUnavailable`        | MySQL failed Pods maximum quantity                                                                                                                            | `1`                        |
| `mysql.podDisruptionBudget.minAvailable`          | MySQL available Pods minimum quantity                                                                                                                         | ``                         |
| `mysql.image.repository`                          | MySQL Container image repository                                                                                                                              | `percona/percona-server`   |
| `mysql.image.tag`                                 | MySQL Container image tag                                                                                                                                     | `8.4.6-6.1`                |
| `mysql.imagePullPolicy`                           | The policy used to update images                                                                                                                              | `Always`                   |
| `mysql.imagePullSecrets`                          | MySQL Container pull secret                                                                                                                                   | `[]`                       |
| `mysql.initContainer.image`                       | An alternative image for the initial Operator installation                                                                                                    | `""`                       |
| `mysql.initContainer.containerSecurityContext`    | A custom Kubernetes Security Context for an init container                                                                                                    | `{}`                       |
| `mysql.initContainer.resources.requests`          | Init container resource requests                                                                                                                              | `{}`                       |
| `mysql.initContainer.resources.limits`            | Init container resource limits                                                                                                                                | `{}`                       |
| `mysql.size`                                      | Number of MySQL pods                                                                                                                                          | `3`                        |
| `mysql.annotations`                               | MySQL Pods user-defined annotations                                                                                                                           | `{}`                       |
| `mysql.priorityClassName`                         | MySQL Pods priority Class defined by user                                                                                                                     | `""`                       |
| `mysql.runtimeClassName`                          | Name of the Kubernetes Runtime Class for MySQL Pods                                                                                                           | `""`                       |
| `mysql.labels`                                    | MySQL Pods user-defined labels                                                                                                                                | `{}`                       |
| `mysql.schedulerName`                             | The Kubernetes Scheduler                                                                                                                                      | `""`                       |
| `mysql.resources.requests`                        | MySQL Pods resource requests                                                                                                                                  | `memory: 512M`             |
| `mysql.resources.limits`                          | MySQL Pods resource limits                                                                                                                                    | `memory: 1G`               |
| `mysql.livenessProbe`                             | MySQL Pods livenessProbe structure                                                                                                                            | `{}`                       |
| `mysql.readinessProbe`                            | MySQL Pods readinessProbe structure                                                                                                                           | `{}`                       |
| `mysql.nodeSelector`                              | MySQL Pods key-value pairs setting for K8S node assignment                                                                                                    | `{}`                       |
| `mysql.affinity.antiAffinityTopologyKey`          | MySQL Pods simple scheduling restriction on/off for host, zone, region                                                                                        | `"kubernetes.io/hostname"` |
| `mysql.affinity.advanced`                         | MySQL Pods advanced scheduling restriction with match expression engine                                                                                       | `{}`                       |
| `mysql.topologySpreadConstraints`                 | The Label selector for the [Kubernetes Pod Topology Spread Constraints](https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/) | `[]`                       |
| `mysql.tolerations`                               | List of node taints to tolerate for MySQL Pods                                                                                                                | `[]`                       |
| `mysql.expose.enabled`                            | Allow access to MySQL from outside of Kubernetes                                                                                                              | `false`                    |
| `mysql.expose.type`                               | Network service access point type                                                                                                                             | `ClusterIP`                |
| `mysql.expose.annotations`                        | Network service annotations                                                                                                                                   | `{}`                       |
| `mysql.expose.externalTrafficPolicy`              | Network service externalTrafficPolicy                                                                                                                         | ``                         |
| `mysql.expose.internalTrafficPolicy`              | Network service internalTrafficPolicy                                                                                                                         | ``                         |
| `mysql.expose.labels`                             | Network service labels                                                                                                                                        | `{}`                       |
| `mysql.expose.loadBalancerSourceRanges`           | The range of client IP addresses from which the load balancer should be reachable                                                                             | `[]`                       |
| `mysql.exposePrimary.enabled`                     | Allow access to MySQL primary from outside of Kubernetes                                                                                                      | `false`                    |
| `mysql.exposePrimary.type`                        | Network service access point type                                                                                                                             | `ClusterIP`                |
| `mysql.exposePrimary.annotations`                 | Network service annotations                                                                                                                                   | `{}`                       |
| `mysql.exposePrimary.externalTrafficPolicy`       | Network service externalTrafficPolicy                                                                                                                         | ``                         |
| `mysql.exposePrimary.internalTrafficPolicy`       | Network service internalTrafficPolicy                                                                                                                         | ``                         |
| `mysql.exposePrimary.labels`                      | Network service labels                                                                                                                                        | `{}`                       |
| `mysql.exposePrimary.loadBalancerSourceRanges`    | The range of client IP addresses from which the load balancer should be reachable                                                                             | `[]`                       |
| `mysql.volumeSpec`                                | MySQL Pods storage resources                                                                                                                                  | `{}`                       |
| `mysql.volumeSpec.pvc`                            | MySQL Pods PVC request parameters                                                                                                                             |                            |
| `mysql.volumeSpec.pvc.storageClassName`           | MySQL Pods PVC target storageClass                                                                                                                            | `""`                       |
| `mysql.volumeSpec.pvc.accessModes`                | MySQL Pods PVC access policy                                                                                                                                  | `[]`                       |
| `mysql.volumeSpec.pvc.resources.requests.storage` | MySQL Pods PVC storage size                                                                                                                                   | `3G`                       |
| `mysql.volumeSpec.hostPath`                       | MySQL Pods hostPath parameters                                                                                                                                |                            |
| `mysql.volumeSpec.hostPath.path`                  | MySQL Pods local path for data volume                                                                                                                         | `""`                       |
| `mysql.volumeSpec.hostPath.type`                  | MySQL Pods type of hostPath                                                                                                                                   | `Directory`                |
| `mysql.volumeSpec.emptyDir`                       | MySQL Pods data volume using ephemeral storage                                                                                                                | `{}`                       |
| `mysql.gracePeriod`                               | MySQL Pods termination grace period                                                                                                                           | `600`                      |
| `mysql.configuration`                             | Custom config for MySQL                                                                                                                                       | `""`                       |
| `mysql.sidecars`                                  | MySQL Pod sidecars                                                                                                                                            | `{}`                       |
| `mysql.sidecarVolumes`                            | MySQL Pod sidecar volumes                                                                                                                                     | `[]`                       |
| `mysql.sidecarPVCs`                               | MySQL Pod sidecar PVCs                                                                                                                                        | `[]`                       |
| `mysql.containerSecurityContext`                  | A custom Kubernetes Security Context for a Container to be used instead of the default one                                                                    | `{}`                       |
| `mysql.podSecurityContext`                        | A custom Kubernetes Security Context for a Pod to be used instead of the default one                                                                          | `{}`                       |
| `mysql.serviceAccountName`                        | A custom service account to be used instead of the default one                                                                                                | `""`                       |
||
| `proxy.haproxy.enabled`                                | Enable/Disable HAProxy pods                                                                                                                                   | `true`                     |
| `proxy.haproxy.image.repository`                       | HAProxy Container image repository                                                                                                                            | `percona/haproxy`          |
| `proxy.haproxy.image.tag`                              | HAProxy Container image tag                                                                                                                                   | `2.8.15`                   |
| `proxy.haproxy.imagePullPolicy`                        | The policy used to update images                                                                                                                              | `Always`                   |
| `proxy.haproxy.imagePullSecrets`                       | HAProxy Container pull secret                                                                                                                                 | `[]`                       |
| `proxy.haproxy.initImage`                              | An alternative image for the initial haproxy setup                                                                                                            | `""`                       |
| `proxy.haproxy.initContainer.image`                    | An alternative image for the initial Operator installation                                                                                                    | `""`                       |
| `proxy.haproxy.initContainer.containerSecurityContext` | A custom Kubernetes Security Context for an init container                                                                                                    | `{}`                       |
| `proxy.haproxy.initContainer.resources.requests`       | Init container resource requests                                                                                                                              | `{}`                       |
| `proxy.haproxy.initContainer.resources.limits`         | Init container resource limits                                                                                                                                | `{}`                       |
| `proxy.haproxy.size`                                   | HAProxy size (pod quantity)                                                                                                                                   | `3`                        |
| `proxy.haproxy.annotations`                            | HAProxy Pods user-defined annotations                                                                                                                         | `{}`                       |
| `proxy.haproxy.priorityClassName`                      | HAProxy Pods priority Class defined by user                                                                                                                   | `""`                       |
| `proxy.haproxy.runtimeClassName`                       | Name of the Kubernetes Runtime Class for HAProxy Pods                                                                                                         | `""`                       |
| `proxy.haproxy.labels`                                 | HAProxy Pods user-defined labels                                                                                                                              | `{}`                       |
| `proxy.haproxy.schedulerName`                          | The Kubernetes Scheduler                                                                                                                                      | `""`                       |
| `proxy.haproxy.nodeSelector`                           | HAProxy Pods key-value pairs setting for K8S node assignment                                                                                                  | `{}`                       |
| `proxy.haproxy.podDisruptionBudget.maxUnavailable`     | HAProxy failed Pods maximum quantity                                                                                                                          | `1`                        |
| `proxy.haproxy.podDisruptionBudget.minAvailable`       | HAProxy available Pods minimum quantity                                                                                                                       | ``                         |
| `proxy.haproxy.affinity.antiAffinityTopologyKey`       | HAProxy Pods simple scheduling restriction on/off for host, zone, region                                                                                      | `"kubernetes.io/hostname"` |
| `proxy.haproxy.affinity.advanced`                      | HAProxy Pods advanced scheduling restriction with match expression engine                                                                                     | `{}`                       |
| `proxy.haproxy.topologySpreadConstraints`              | The Label selector for the [Kubernetes Pod Topology Spread Constraints](https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/) | `[]`                       |
| `proxy.haproxy.tolerations`                            | List of node taints to tolerate for HAProxy Pods                                                                                                              | `[]`                       |
| `proxy.haproxy.resources.requests`                     | HAProxy Pods resource requests                                                                                                                                | `memory: 1G cpu: 600m`     |
| `proxy.haproxy.resources.limits`                       | HAProxy Pods resource limits                                                                                                                                  | `{}`                       |
| `proxy.haproxy.env`                                    | HAProxy Pods set env variable                                                                                                                                 | `[]`                       |
| `proxy.haproxy.envFrom`                                | HAProxy Pods set env variable from secret                                                                                                                     | `[]`                       |
| `proxy.haproxy.livenessProbe`                          | HAProxy Pods livenessProbe structure                                                                                                                          | `{}`                       |
| `proxy.haproxy.readinessProbe`                         | HAProxy Pods readinessProbe structure                                                                                                                         | `{}`                       |
| `proxy.haproxy.configuration`                          | Custom config for HAProxy                                                                                                                                     | `""`                       |
| `proxy.haproxy.containerSecurityContext`               | A custom Kubernetes Security Context for a Container to be used instead of the default one                                                                    | `{}`                       |
| `proxy.haproxy.podSecurityContext`                     | A custom Kubernetes Security Context for a Pod to be used instead of the default one                                                                          | `{}`                       |
| `proxy.haproxy.serviceAccountName`                     | A custom service account to be used instead of the default one                                                                                                | `""`                       |
| `proxy.haproxy.expose.type`                            | Network service access point type                                                                                                                             | `""`                       |
| `proxy.haproxy.expose.annotations`                     | Network service annotations                                                                                                                                   | `{}`                       |
| `proxy.haproxy.expose.externalTrafficPolicy`           | Network service externalTrafficPolicy                                                                                                                         | ``                         |
| `proxy.haproxy.expose.internalTrafficPolicy`           | Network service internalTrafficPolicy                                                                                                                         | ``                         |
| `proxy.haproxy.expose.labels`                          | Network service labels                                                                                                                                        | `{}`                       |
| `proxy.haproxy.expose.loadBalancerSourceRanges`        | The range of client IP addresses from which the load balancer should be reachable                                                                             | `[]`                       |
||
| `proxy.router.enabled`                                | Enable/Disable Router pods in group replication                                                                                                               | `false`                        |
| `proxy.router.image.repository`                       | Router Container image repository                                                                                                                             | `percona/percona-mysql-router` |
| `proxy.router.image.tag`                              | Router Container image tag                                                                                                                                    | `8.4.6`                        |
| `proxy.router.imagePullPolicy`                        | The policy used to update images                                                                                                                              | `Always`                       |
| `proxy.router.imagePullSecrets`                       | Router Container pull secret                                                                                                                                  | `[]`                           |
| `proxy.router.initContainer.image`                    | An alternative image for the initial Operator installation                                                                                                    | `""`                           |
| `proxy.router.initContainer.containerSecurityContext` | A custom Kubernetes Security Context for an init container                                                                                                    | `{}`                           |
| `proxy.router.initContainer.resources.requests`       | Init container resource requests                                                                                                                              | `{}`                           |
| `proxy.router.initContainer.resources.limits`         | Init container resource limits                                                                                                                                | `{}`                           |
| `proxy.router.size`                                   | Router size (pod quantity)                                                                                                                                    | `3`                            |
| `proxy.router.annotations`                            | Router Pods user-defined annotations                                                                                                                          | `{}`                           |
| `proxy.router.priorityClassName`                      | Router Pods priority Class defined by user                                                                                                                    | `""`                           |
| `proxy.router.runtimeClassName`                       | Name of the Kubernetes Runtime Class for Router Pods                                                                                                          | `""`                           |
| `proxy.router.labels`                                 | Router Pods user-defined labels                                                                                                                               | `{}`                           |
| `proxy.router.schedulerName`                          | The Kubernetes Scheduler                                                                                                                                      | `""`                           |
| `proxy.router.nodeSelector`                           | Router Pods key-value pairs setting for K8S node assignment                                                                                                   | `{}`                           |
| `proxy.router.podDisruptionBudget.maxUnavailable`     | Router failed Pods maximum quantity                                                                                                                           | `1`                            |
| `proxy.router.podDisruptionBudget.minAvailable`       | Router available Pods minimum quantity                                                                                                                        | ``                             |
| `proxy.router.affinity.antiAffinityTopologyKey`       | Router Pods simple scheduling restriction on/off for host, zone, region                                                                                       | `"kubernetes.io/hostname"`     |
| `proxy.router.affinity.advanced`                      | Router Pods advanced scheduling restriction with match expression engine                                                                                      | `{}`                           |
| `proxy.router.topologySpreadConstraints`              | The Label selector for the [Kubernetes Pod Topology Spread Constraints](https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/) | `[]`                           |
| `proxy.router.configuration`                          | User defined Router options according to Router configuration file syntax                                                                                     | ``                             |
| `proxy.router.tolerations`                            | List of node taints to tolerate for Router Pods                                                                                                               | `[]`                           |
| `proxy.router.resources.requests`                     | Router Pods resource requests                                                                                                                                 | `memory: 256M`                 |
| `proxy.router.resources.limits`                       | Router Pods resource limits                                                                                                                                   | `memory: 256M`                 |
| `proxy.router.containerSecurityContext`               | A custom Kubernetes Security Context for a Container to be used instead of the default one                                                                    | `{}`                           |
| `proxy.router.podSecurityContext`                     | A custom Kubernetes Security Context for a Pod to be used instead of the default one                                                                          | `{}`                           |
| `proxy.router.serviceAccountName`                     | A custom service account to be used instead of the default one                                                                                                | `""`                           |
| `proxy.router.expose.type`                            | Network service access point type                                                                                                                             | `""`                           |
| `proxy.router.expose.annotations`                     | Network service annotations                                                                                                                                   | `{}`                           |
| `proxy.router.expose.externalTrafficPolicy`           | Network service externalTrafficPolicy                                                                                                                         | ``                             |
| `proxy.router.expose.internalTrafficPolicy`           | Network service internalTrafficPolicy                                                                                                                         | ``                             |
| `proxy.router.expose.labels`                          | Network service labels                                                                                                                                        | `{}`                           |
| `proxy.router.expose.loadBalancerSourceRanges`        | The range of client IP addresses from which the load balancer should be reachable                                                                             | `[]`                           |
||
| `orchestrator.enabled`                                   | Enable/Disable orchestrator pods in async replication                                                                                                         | `true`                         |
| `orchestrator.image.repository`                          | Orchestrator Container image repository                                                                                                                       | `percona/percona-orchestrator` |
| `orchestrator.image.tag`                                 | Orchestrator Container image tag                                                                                                                              | `3.2.6-18`                     |
| `orchestrator.imagePullPolicy`                           | The policy used to update images                                                                                                                              | `Always`                       |
| `orchestrator.imagePullSecrets`                          | Orchestrator Container pull secret                                                                                                                            | `[]`                           |
| `orchestrator.serviceAccountName`                        | A custom service account to be used instead of the default one                                                                                                | `""`                           |
| `orchestrator.initContainer.image`                       | An alternative image for the initial Operator installation                                                                                                    | `""`                           |
| `orchestrator.initContainer.containerSecurityContext`    | A custom Kubernetes Security Context for an init container                                                                                                    | `{}`                           |
| `orchestrator.initContainer.resources.requests`          | Init container resource requests                                                                                                                              | `{}`                           |
| `orchestrator.initContainer.resources.limits`            | Init container resource limits                                                                                                                                | `{}`                           |
| `orchestrator.size`                                      | Orchestrator size (pod quantity)                                                                                                                              | `3`                            |
| `orchestrator.annotations`                               | Orchestrator Pods user-defined annotations                                                                                                                    | `{}`                           |
| `orchestrator.priorityClassName`                         | Orchestrator Pods priority Class defined by user                                                                                                              | `""`                           |
| `orchestrator.runtimeClassName`                          | Name of the Kubernetes Runtime Class for Orchestrator Pods                                                                                                    | `""`                           |
| `orchestrator.labels`                                    | Orchestrator Pods user-defined labels                                                                                                                         | `{}`                           |
| `orchestrator.schedulerName`                             | The Kubernetes Scheduler                                                                                                                                      | `""`                           |
| `orchestrator.nodeSelector`                              | Orchestrator Pods key-value pairs setting for K8S node assignment                                                                                             | `{}`                           |
| `orchestrator.affinity.antiAffinityTopologyKey`          | Orchestrator Pods simple scheduling restriction on/off for host, zone, region                                                                                 | `"kubernetes.io/hostname"`     |
| `orchestrator.affinity.advanced`                         | Orchestrator Pods advanced scheduling restriction with match expression engine                                                                                | `{}`                           |
| `orchestrator.topologySpreadConstraints`                 | The Label selector for the [Kubernetes Pod Topology Spread Constraints](https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/) | `[]`                           |
| `orchestrator.tolerations`                               | List of node taints to tolerate for Orchestrator Pods                                                                                                         | `[]`                           |
| `orchestrator.resources.requests`                        | Orchestrator Pods resource requests                                                                                                                           | `memory: 128M`                 |
| `orchestrator.resources.limits`                          | Orchestrator Pods resource limits                                                                                                                             | `memory: 256M`                 |
| `orchestrator.podDisruptionBudget.maxUnavailable`        | Orchestrator failed Pods maximum quantity                                                                                                                     | `1`                            |
| `orchestrator.podDisruptionBudget.minAvailable`          | Orchestrator available Pods minimum quantity                                                                                                                  | ``                             |
| `orchestrator.volumeSpec`                                | Orchestrator Pods storage resources                                                                                                                           | `{}`                           |
| `orchestrator.volumeSpec.pvc`                            | Orchestrator Pods PVC request parameters                                                                                                                      |                                |
| `orchestrator.volumeSpec.pvc.storageClassName`           | Orchestrator Pods PVC target storageClass                                                                                                                     | `""`                           |
| `orchestrator.volumeSpec.pvc.accessModes`                | Orchestrator Pods PVC access policy                                                                                                                           | `[]`                           |
| `orchestrator.volumeSpec.pvc.resources.requests.storage` | Orchestrator Pods PVC storage size                                                                                                                            | `1G`                           |
| `orchestrator.gracePeriod`                               | Orchestrator Pods termination grace period                                                                                                                    | `30`                           |
| `orchestrator.containerSecurityContext`                  | A custom Kubernetes Security Context for a Container to be used instead of the default one                                                                    | `{}`                           |
| `orchestrator.podSecurityContext`                        | A custom Kubernetes Security Context for a Pod to be used instead of the default one                                                                          | `{}`                           |
| `orchestrator.expose.type`                               | Network service access point type                                                                                                                             | `""`                           |
| `orchestrator.expose.annotations`                        | Network service annotations                                                                                                                                   | `{}`                           |
| `orchestrator.expose.externalTrafficPolicy`              | Network service externalTrafficPolicy                                                                                                                         | ``                             |
| `orchestrator.expose.internalTrafficPolicy`              | Network service internalTrafficPolicy                                                                                                                         | ``                             |
| `orchestrator.expose.labels`                             | Network service labels                                                                                                                                        | `{}`                           |
| `orchestrator.expose.loadBalancerSourceRanges`           | The range of client IP addresses from which the load balancer should be reachable                                                                             | `[]`                           |
||
| `pmm.image.repository`                    | PMM Container image repository                                                                                                                                                                        | `percona/pmm-client`                |
| `pmm.image.tag`                           | PMM Container image tag                                                                                                                                                                               | `3.4.0`                             |
| `pmm.imagePullPolicy`                     | The policy used to update images                                                                                                                                                                      | ``                                  |
| `pmm.readinessProbes.failureThreshold`    | When a probe fails, Kubernetes will try failureThreshold times before giving up                                                                                                                       | `5`                                 |
| `pmm.readinessProbes.initialDelaySeconds` | Number of seconds after the container has started before liveness or readiness probes are initiated                                                                                                   | `15`                                |
| `pmm.readinessProbes.periodSeconds`       | How often (in seconds) to perform the probe                                                                                                                                                           | `30`                                |
| `pmm.readinessProbes.successThreshold`    | Minimum consecutive successes for the probe to be considered successful after having failed                                                                                                           | `1`                                 |
| `pmm.readinessProbes.timeoutSeconds`      | Number of seconds after which the probe times out                                                                                                                                                     | `15`                                |
| `pmm.livenessProbes.failureThreshold`     | When a probe fails, Kubernetes will try failureThreshold times before giving up                                                                                                                       | `3`                                 |
| `pmm.livenessProbes.initialDelaySeconds`  | Number of seconds after the container has started before liveness or readiness probes are initiated                                                                                                   | `300`                               |
| `pmm.livenessProbes.periodSeconds`        | How often (in seconds) to perform the probe                                                                                                                                                           | `10`                                |
| `pmm.livenessProbes.successThreshold`     | Minimum consecutive successes for the probe to be considered successful after having failed                                                                                                           | `1`                                 |
| `pmm.livenessProbes.timeoutSeconds`       | Number of seconds after which the probe times out                                                                                                                                                     | `5`                                 |
| `pmm.serverHost`                          | PMM server related K8S service hostname                                                                                                                                                               | `monitoring-service`                |
| `pmm.mysqlParams`                         | Additional parameters which will be passed to the [pmm-admin add mysql](https://docs.percona.com/percona-monitoring-and-management/setting-up/client/mysql.html#add-service) command for `mysql` Pods | `""`                                |
| `pmm.resources.requests`                  | PMM Container resource requests                                                                                                                                                                       | `{"memory": "150M", "cpu": "300m"}` |
| `pmm.resources.limits`                    | PMM Container resource limits                                                                                                                                                                         | `{}`                                |
||
| `toolkit.image.repository`   | Percona Toolkit Container image repository | `percona/percona-toolkit` |
| `toolkit.image.tag`          | Percona Toolkit Container image tag        | `3.7.0-2`                 |
| `toolkit.imagePullPolicy`    | The policy used to update images           | ``                        |
| `toolkit.resources.requests` | Toolkit Container resource requests        | `{}`                      |
| `toolkit.resources.limits`   | Toolkit Container resource limits          | `{}`                      |
||
| `backup.enabled`                                | Enable backups                                                                              | `true`                       |
| `backup.sourcePod`                              | Specify backup source pod                                                                   | ``                           |
| `backup.image.repository`                       | Backup Container image repository                                                           | `percona/percona-xtrabackup` |
| `backup.image.tag`                              | Backup Container image tag                                                                  | `8.4.0-4.1`                  |
| `backup.backoffLimit`                           | The number of retries to make a backup                                                      | ``                           |
| `backup.imagePullPolicy`                        | The policy used to update images                                                            | `Always`                     |
| `backup.imagePullSecrets`                       | Backup Container pull secret                                                                | `[]`                         |
| `backup.initContainer.image`                    | An alternative image for the initial Operator installation                                  | `""`                         |
| `backup.initContainer.containerSecurityContext` | A custom Kubernetes Security Context for an init container                                  | `{}`                         |
| `backup.initContainer.resources.requests`       | Init container resource requests                                                            | `{}`                         |
| `backup.initContainer.resources.limits`         | Init container resource limits                                                              | `{}`                         |
| `backup.serviceAccountName`                     | Run Backup Container under specified K8S SA                                                 | `""`                         |
| `backup.containerSecurityContext`               | A custom Kubernetes Security Context for a Container to be used instead of the default one  | `{}`                         |
| `backup.resources`                              | Backup Pods resource requests and limits                                                    | `{}`                         |
| `backup.storages`                               | Local/remote backup storages settings                                                       | `{}`                         |
| `backup.schedule`                               | Backup execution timetable                                                                  | `[]`                         |
| `backup.schedule.[0].name`                      | Backup execution timetable name                                                             | `daily-backup`               |
| `backup.schedule.[0].schedule`                  | Backup execution timetable cron timing                                                      | `0 0 * * *`                  |
| `backup.schedule.[0].keep`                      | Backup items to keep                                                                        | `5`                          |
| `backup.schedule.[0].storageName`               | Backup target storage                                                                       | `fs-pvc`                     |
||
| `passwords` | Cluster user passwords (by default generated by operator) | `{}` |


Specify parameters using `--set key=value[,key=value]` argument to `helm install`
Notice that you can use multiple replica sets only with sharding enabled.

## Examples

### Deploy a database cluster with specific storage size

This is starting a cluster with specific PVC size.

```bash
$ helm install dev  --namespace ps . \
    --set "mysql.volumeSpec.pvc.resources.requests.storage=20G"
```
